import datetime

trades = [{'id': '220779697', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 5, 4, 39, 1, 382000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-05 06:39:01.382', 'commission': -0.56, 'swap': 0, 'profit': 2.4, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306158728', 'positionId': '306158458', 'volume': 0.16, 'price': 1.05771, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_EXPERT', 'brokerComment': 'ZfKC_+6TPow_jel89SD4U:', 'accountCurrencyExchangeRate': 1, 'clientId': 'ZfKC_+6TPow_jel89SD4U'}, {'id': '220779866', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 5, 4, 39, 33, 827000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-05 06:39:33.827', 'commission': -0.35, 'swap': 0, 'profit': -1.1, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306158928', 'positionId': '306158912', 'volume': 0.1, 'price': 1.05793, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '220780143', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 5, 4, 41, 44, 979000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-05 06:41:44.979', 'commission': -0.21, 'swap': 0, 'profit': 0.06, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306159271', 'positionId': '306159247', 'volume': 0.06, 'price': 1.05792, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_EXPERT', 'brokerComment': 'ZfKC_+6TPpR_Zxd0QISPL:', 'accountCurrencyExchangeRate': 1, 'clientId': 'ZfKC_+6TPpR_XCBtMPuqy'}, {'id': '220780170', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 5, 4, 42, 4, 410000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-05 06:42:04.410', 'commission': -0.14, 'swap': 0, 'profit': -0.04, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306159330', 'positionId': '306159247', 'volume': 0.04, 'price': 1.05794, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_EXPERT', 'brokerComment': 'ZfKC_+6TPpR_iRxJ1gQ7H:', 'accountCurrencyExchangeRate': 1, 'clientId': 'ZfKC_+6TPpR_XCBtMPuqy'}, {'id': '220780514', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 5, 4, 44, 23, 674000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-05 06:44:23.674', 'commission': -0.18, 'swap': 0, 'profit': -0.05, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306159760', 'positionId': '306159247', 'volume': 0.05, 'price': 1.05794, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_EXPERT', 'brokerComment': 'ZfKC_+6TPpR_XCBtMPuqy:', 'accountCurrencyExchangeRate': 1, 'clientId': 'ZfKC_+6TPpR_XCBtMPuqy'}, {'id': '221336937', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 6, 7, 15, 44, 497000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-06 09:15:44.497', 'commission': -0.35, 'swap': 0, 'profit': 0.1, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306857469', 'positionId': '306857436', 'volume': 0.1, 'price': 1.04861, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221336942', 'platform': 'mt5', 'type': 'DEAL_TYPE_SELL', 'time': datetime.datetime(2022, 12, 6, 7, 15, 46, 675000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-06 09:15:46.675', 'commission': -0.35, 'swap': 0, 'profit': -1.4, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306857475', 'positionId': '306857383', 'volume': 0.1, 'price': 1.0486, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221339488', 'platform': 'mt5', 'type': 'DEAL_TYPE_SELL', 'time': datetime.datetime(2022, 12, 6, 7, 25, 49, 192000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-06 09:25:49.192', 'commission': -0.56, 'swap': 0, 'profit': -1.28, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306860505', 'positionId': '306860501', 'volume': 0.16, 'price': 1.04856, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221339564', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 6, 7, 26, 11, 84000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-06 09:26:11.084', 'commission': -0.35, 'swap': 0, 'profit': -0.3, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306860602', 'positionId': '306860539', 'volume': 0.1, 'price': 1.04842, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221339580', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 6, 7, 26, 19, 932000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-06 09:26:19.932', 'commission': -0.21, 'swap': 0, 'profit': 0, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306860618', 'positionId': '306860539', 'volume': 0.06, 'price': 1.04839, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221355381', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 6, 8, 8, 25, 754000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-06 10:08:25.754', 'commission': -0.18, 'swap': 0, 'profit': -0.35, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306879021', 'positionId': '306878965', 'volume': 0.05, 'price': 1.05041, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221355419', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 6, 8, 8, 47, 145000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-06 10:08:47.145', 'commission': -0.18, 'swap': 0, 'profit': -0.4, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306879066', 'positionId': '306878965', 'volume': 0.05, 'price': 1.05042, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221355530', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 6, 8, 9, 7, 270000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-06 10:09:07.270', 'commission': -0.18, 'swap': 0, 'profit': -0.4, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306879203', 'positionId': '306878965', 'volume': 0.05, 'price': 1.05042, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221355602', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 6, 8, 9, 29, 836000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-06 10:09:29.836', 'commission': -0.18, 'swap': 0, 'profit': -1.3, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306879282', 'positionId': '306878965', 'volume': 0.05, 'price': 1.0506, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221356206', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 6, 8, 11, 58, 260000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-06 10:11:58.260', 'commission': -0.7, 'swap': 0, 'profit': -0.8, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306880038', 'positionId': '306880026', 'volume': 0.2, 'price': 1.0504, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221356273', 'platform': 'mt5', 'type': 'DEAL_TYPE_SELL', 'time': datetime.datetime(2022, 12, 6, 8, 12, 6, 466000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-06 10:12:06.466', 'commission': -0.7, 'swap': 0, 'profit': -0.8, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306880126', 'positionId': '306880050', 'volume': 0.2, 'price': 1.05035, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221356389', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 6, 8, 12, 30, 231000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-06 10:12:30.231', 'commission': -0.35, 'swap': 0, 'profit': -1.6, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306880246', 'positionId': '306880167', 'volume': 0.1, 'price': 1.05037, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221356418', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 6, 8, 12, 54, 726000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-06 10:12:54.726', 'commission': -0.18, 'swap': 0, 'profit': -0.7, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306880282', 'positionId': '306880167', 'volume': 0.05, 'price': 1.05035, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221356491', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 6, 8, 13, 12, 729000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-06 10:13:12.729', 'commission': -0.18, 'swap': 0, 'profit': -1.6, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306880383', 'positionId': '306880167', 'volume': 0.05, 'price': 1.05053, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221356531', 'platform': 'mt5', 'type': 'DEAL_TYPE_SELL', 'time': datetime.datetime(2022, 12, 6, 8, 13, 34, 138000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-06 10:13:34.138', 'commission': -0.7, 'swap': 0, 'profit': -0.2, 'symbol': 'EURUSD', 'magic': 0, 'orderId': '306880429', 'positionId': '306880404', 'volume': 0.2, 'price': 1.05051, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221715746', 'platform': 'mt5', 'type': 'DEAL_TYPE_SELL', 'time': datetime.datetime(2022, 12, 7, 0, 35, 3, 561000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-07 02:35:03.561', 'commission': -0.35, 'swap': 0, 'profit': 0.1, 'symbol': 'GBPUSD', 'magic': 0, 'orderId': '307334378', 'positionId': '307334320', 'volume': 0.1, 'price': 1.21277, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221715796', 'platform': 'mt5', 'type': 'DEAL_TYPE_SELL', 'time': datetime.datetime(2022, 12, 7, 0, 35, 33, 934000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-07 02:35:33.934', 'commission': -0.18, 'swap': 0, 'profit': -0.3, 'symbol': 'GBPUSD', 'magic': 0, 'orderId': '307334473', 'positionId': '307334320', 'volume': 0.05, 'price': 1.2127, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221715991', 'platform': 'mt5', 'type': 'DEAL_TYPE_SELL', 'time': datetime.datetime(2022, 12, 7, 0, 36, 11, 473000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-07 02:36:11.473', 'commission': -0.18, 'swap': 0, 'profit': -0.1, 'symbol': 'GBPUSD', 'magic': 0, 'orderId': '307334718', 'positionId': '307334320', 'volume': 0.05, 'price': 1.21274, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221720899', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 7, 0, 58, 5, 21000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-07 02:58:05.021', 'commission': -0.35, 'swap': 0, 'profit': -0.29, 'symbol': 'USDJPY', 'magic': 0, 'orderId': '307340822', 'positionId': '307340779', 'volume': 0.1, 'price': 137.176, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221720951', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 7, 0, 58, 24, 246000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-07 02:58:24.246', 'commission': -0.18, 'swap': 0, 'profit': 0, 'symbol': 'USDJPY', 'magic': 0, 'orderId': '307340900', 'positionId': '307340779', 'volume': 0.05, 'price': 137.172, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221721079', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 7, 0, 59, 3, 817000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-07 02:59:03.817', 'commission': -0.18, 'swap': 0, 'profit': -0.22, 'symbol': 'USDJPY', 'magic': 0, 'orderId': '307341056', 'positionId': '307340779', 'volume': 0.05, 'price': 137.178, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221791563', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 7, 6, 27, 33, 128000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-07 08:27:33.128', 'commission': -0.7, 'swap': 0, 'profit': 1.16, 'symbol': 'USDJPY', 'magic': 0, 'orderId': '307429998', 'positionId': '307429988', 'volume': 0.2, 'price': 137.743, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '221793542', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 7, 6, 36, 25, 387000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-07 08:36:25.387', 'commission': -0.7, 'swap': 0, 'profit': 0.44, 'symbol': 'USDJPY', 'magic': 0, 'orderId': '307432488', 'positionId': '307432483', 'volume': 0.2, 'price': 137.794, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '222220289', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 8, 2, 26, 47, 706000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-08 04:26:47.706', 'commission': -0.14, 'swap': 0, 'profit': 0.06, 'symbol': 'USDJPY', 'magic': 0, 'orderId': '307963097', 'positionId': '307963084', 'volume': 0.04, 'price': 136.955, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '222220302', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 8, 2, 26, 59, 225000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-08 04:26:59.225', 'commission': -0.11, 'swap': 0, 'profit': 0.22, 'symbol': 'USDJPY', 'magic': 0, 'orderId': '307963111', 'positionId': '307963084', 'volume': 0.03, 'price': 136.947, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '222220319', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 8, 2, 27, 3, 882000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-08 04:27:03.882', 'commission': -0.11, 'swap': 0, 'profit': 0.22, 'symbol': 'USDJPY', 'magic': 0, 'orderId': '307963151', 'positionId': '307963084', 'volume': 0.03, 'price': 136.947, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '222223090', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 8, 2, 46, 15, 976000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-08 04:46:15.976', 'commission': -0.07, 'swap': 0, 'profit': -0.06, 'symbol': 'GBPUSD', 'magic': 0, 'orderId': '307966590', 'positionId': '307966481', 'volume': 0.02, 'price': 1.21899, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '222223139', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 8, 2, 46, 44, 266000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-08 04:46:44.266', 'commission': -0.14, 'swap': 0, 'profit': -0.24, 'symbol': 'GBPUSD', 'magic': 0, 'orderId': '307966643', 'positionId': '307966481', 'volume': 0.04, 'price': 1.21902, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '222223363', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 8, 2, 47, 10, 533000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-08 04:47:10.533', 'commission': -0.07, 'swap': 0, 'profit': -0.84, 'symbol': 'GBPUSD', 'magic': 0, 'orderId': '307966889', 'positionId': '307966481', 'volume': 0.02, 'price': 1.21938, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '222223412', 'platform': 'mt5', 'type': 'DEAL_TYPE_BUY', 'time': datetime.datetime(2022, 12, 8, 2, 47, 37, 684000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-08 04:47:37.684', 'commission': -0.07, 'swap': 0, 'profit': -0.64, 'symbol': 'GBPUSD', 'magic': 0, 'orderId': '307966944', 'positionId': '307966481', 'volume': 0.02, 'price': 1.21928, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '222238290', 'platform': 'mt5', 'type': 'DEAL_TYPE_SELL', 'time': datetime.datetime(2022, 12, 8, 4, 14, 17, 807000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-08 06:14:17.807', 'commission': -0.35, 'swap': 0, 'profit': -0.7, 'symbol': 'GBPUSD', 'magic': 0, 'orderId': '307987171', 'positionId': '307987082', 'volume': 0.1, 'price': 1.21898, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '222246649', 'platform': 'mt5', 'type': 'DEAL_TYPE_SELL', 'time': datetime.datetime(2022, 12, 8, 5, 23, 21, 250000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-08 07:23:21.250', 'commission': -0.35, 'swap': 0, 'profit': -1.1, 'symbol': 'EURGBP', 'magic': 0, 'orderId': '307999525', 'positionId': '307999430', 'volume': 0.1, 'price': 0.86169, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '222249619', 'platform': 'mt5', 'type': 'DEAL_TYPE_SELL', 'time': datetime.datetime(2022, 12, 8, 5, 49, 52, 736000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-08 07:49:52.736', 'commission': -0.35, 'swap': 0, 'profit': -0.8, 'symbol': 'AUDJPY', 'magic': 0, 'orderId': '308003716', 'positionId': '308003670', 'volume': 0.1, 'price': 92.007, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_CLIENT', 'accountCurrencyExchangeRate': 1}, {'id': '222250387', 'platform': 'mt5', 'type': 'DEAL_TYPE_SELL', 'time': datetime.datetime(2022, 12, 8, 5, 56, 10, 626000, tzinfo=datetime.timezone.utc), 'brokerTime': '2022-12-08 07:56:10.626', 'commission': -0.53, 'swap': 0, 'profit': -1.86, 'symbol': 'AUDJPY', 'magic': 0, 'orderId': '308004850', 'positionId': '308004728', 'volume': 0.15, 'price': 92.021, 'entryType': 'DEAL_ENTRY_OUT', 'reason': 'DEAL_REASON_EXPERT', 'brokerComment': 'ZfKC_+6ULRz_x7fVNoT5F:', 'accountCurrencyExchangeRate': 1, 'clientId': 'ZfKC_+6ULRz_x7fVNoT5F'}]

print(len(trades))

def unify_partial_orders(trades: list):
    trades2 = trades
    index_list = []
    for trade in trades:
        partial_trades = []
        contador = 0
        for trade2 in trades2:
            contador += 1
            #print("Monitoreando ", len(trades), contador )
            if trade['positionId'] == trade2['positionId'] and trade['orderId'] != trade2['orderId']:
                print()
                print()
                print(trade)
                print()
                print(trade2)
                if trade['positionId'] not in partial_trades:
                    partial_trades.append(trade)
                    index_list.append(trades.index(trade))
                partial_trades.append(trade2)
                trades.remove(trade2)
    try:
        trades.pop(trade.index(index_list[-1]))
    except Exception as err:
        pass

        #print()
        #print("Esto es lo que contiene partial_trades: ", partial_trades)
    return index_list

print("Esto es lo que retorna la función unify_partial_orders(): ", unify_partial_orders(trades))

print(len(trades))
